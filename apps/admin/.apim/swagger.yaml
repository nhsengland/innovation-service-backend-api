info:
  title: Admin API @ NHS Innovation Service
  version: 1.0.0
servers:
  - url: https://nhse-${ENV}-innovation-service-admin-functions.azurewebsites.net/api
openapi: 3.0.3
paths:
  /v1/health:
    get:
      summary: Get admin health
      description: Get admin application health status
      tags:
        - "[v1] health"
      parameters: []
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                      - OK
                      - WARN
        "401":
          description: Unauthorized
        "403":
          description: Forbidden
  /v1/organisations:
    post:
      description: Create an organisation.
      operationId: v1-admin-organisation-create
      requestBody:
        description: The organisation to be created.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 100
                  description: Name of the organisation.
                acronym:
                  type: string
                  maxLength: 10
                  description: Acronym of the organisation.
                units:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                        description: Name of the organisation unit.
                      acronym:
                        type: string
                        description: Acronym of the organisation unit.
                    required:
                      - name
                      - acronym
                    additionalProperties: false
                  description: Organisation units to create.
              required:
                - name
                - acronym
              additionalProperties: false
      responses:
        "200":
          description: The organisation has been created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: The organisation id.
                  units:
                    type: string
                    description: Ids of the organisation units belonging to the organisation.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to create an organisation.
        "500":
          description: An error occurred while creating the organisation.
  "/v1/organisations/{organisationId}":
    patch:
      description: Update an organisation.
      operationId: v1-admin-organisation-update
      parameters:
        - name: organisationId
          in: path
          description: The organisation id.
          required: true
          schema:
            type: string
      requestBody:
        description: New name and acronym for the organisation.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: string
                  description: Name and acronym for the organisation.
      responses:
        "200":
          description: The organisation unit has been updated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  organisationId:
                    type: string
                    description: The organisation id.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to update an organisation unit.
        "404":
          description: The organisation unit does not exist.
        "500":
          description: An error occurred while updating the organisation unit.
  /v1/tou:
    post:
      description: Create terms of use.
      operationId: v1-admin-terms-of-use-create
      requestBody:
        description: The terms of use to create.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Name of the terms of use.
                touType:
                  type: string
                  enum:
                    - INNOVATOR
                    - SUPPORT_ORGANISATION
                  description: Type of the terms of use.
                summary:
                  type: string
                  description: Brief summary of the terms of use.
                releasedAt:
                  type: string
                  description: Relase date of the terms of use.
              required:
                - name
                - touType
              additionalProperties: false
      responses:
        "200":
          description: The terms of use have been created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: Id of the created terms of use.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to create terms of use.
        "500":
          description: An error occurred while creating the terms of use.
  "/v1/tou/{touId}":
    put:
      description: Update terms of use.
      operationId: v1-admin-terms-of-use-update
      parameters:
        - name: touId
          in: path
          required: true
          schema:
            type: string
            format: uuid
            description: The terms of use id.
      requestBody:
        description: The terms of use to be updated.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Name of the terms of use.
                touType:
                  type: string
                  enum:
                    - INNOVATOR
                    - SUPPORT_ORGANISATION
                  description: Type of the terms of use.
                summary:
                  type: string
                  description: Brief summary of the terms of use.
                releasedAt:
                  type: string
                  description: Relase date of the terms of use.
              required:
                - name
                - touType
              additionalProperties: false
      responses:
        "200":
          description: The terms of use have been updated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: Id of the updated terms of use.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to update terms of use.
        "500":
          description: An error occurred while updating the terms of use.
  "/v1/organisations/{organisationId}/units/{organisationUnitId}/activate":
    patch:
      description: Activate an organisation unit.
      operationId: v1-admin-unit-activate
      parameters:
        - name: organisationId
          in: path
          description: The organisation id.
          required: true
          schema:
            type: string
        - name: organisationUnitId
          in: path
          description: The organisation unit id.
          required: true
          schema:
            type: string
      requestBody:
        description: The id of the users to unlock.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: string
                  description: Ids of the users to unlock.
      responses:
        "200":
          description: The organisation unit has been activated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: The organisation unit id.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to activate an organisation unit.
        "404":
          description: The organisation unit does not exist.
        "500":
          description: An error occurred while activating the organisation unit.
  "/v1/organisations/{organisationId}/units/{organisationUnitId}/inactivate":
    patch:
      description: Inactivate an organisation unit.
      operationId: v1-admin-unit-inactivate
      parameters:
        - name: organisationId
          in: path
          description: The organisation id.
          required: true
          schema:
            type: string
        - name: organisationUnitId
          in: path
          description: The organisation unit id.
          required: true
          schema:
            type: string
      responses:
        "200":
          description: The organisation unit has been inactivated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: The organisation unit id.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to inactivate an organisation unit.
        "404":
          description: The organisation unit does not exist.
        "500":
          description: An error occurred while inactivating the organisation unit.
  "/v1/organisations/{organisationId}/units/{organisationUnitId}":
    patch:
      description: Update an organisation unit.
      operationId: v1-admin-unit-update
      parameters:
        - name: organisationId
          in: path
          description: The organisation id.
          required: true
          schema:
            type: string
        - name: organisationUnitId
          in: path
          description: The organisation unit id.
          required: true
          schema:
            type: string
      requestBody:
        description: New name and acronym for the unit.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: string
                  description: Name and acronym for the unit.
      responses:
        "200":
          description: The organisation unit has been updated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: The organisation unit id.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to update an organisation unit.
        "404":
          description: The organisation unit does not exist.
        "500":
          description: An error occurred while updating the organisation unit.
  "/v1/users/{userId}":
    patch:
      description: Update a user.
      operationId: v1-admin-user-update
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
            description: Id of the user to lock.
        - name: id
          in: query
          required: false
          schema:
            type: string
            description: Id of the SLS.
        - name: code
          in: query
          required: false
          schema:
            type: string
            description: Code of the SLS.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accountEnabled:
                  type: boolean
                  nullable: true
                  description: Enable or disable the user.
              additionalProperties: false
      responses:
        "200":
          description: The user has been updated.
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: string
                    description: Id of the user.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to lock a user.
        "404":
          description: The user does not exist.
        "500":
          description: An error occurred while locking a user.
  "/v1/organisations/{organisationId}/units":
    post:
      description: Create an organisation unit.
      operationId: v1-admin-unit-create
      parameters:
        - name: organisationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
            description: Id of the organisation to which the unit will belong to.
      requestBody:
        description: The organisation unit to be created.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  maxLength: 100
                  description: Name of the organisation unit.
                acronym:
                  type: string
                  maxLength: 10
                  description: Acronym of the organisation unit.
              required:
                - name
                - acronym
              additionalProperties: false
      responses:
        "200":
          description: The organisation unit has been created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  unitId:
                    type: string
                    description: The organisation id.
        "400":
          description: Bad request.
        "401":
          description: The user is not authorized to create an organisation unit.
        "500":
          description: An error occurred while creating the organisation unit.
